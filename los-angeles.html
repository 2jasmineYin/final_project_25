<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://use.typekit.net/jez6yrx.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&family=Kalam:wght@300;400;700&display=block" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Leaflet CSS & JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body, html { height: 100%; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        #events-map { height: 100%; width: 100%; z-index: 1; }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
        .leaflet-popup-content-wrapper { border-radius: 8px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .leaflet-popup-content { margin: 12px; font-size: 14px; line-height: 1.4; }
        .day-card:hover { background-color: #f3f4f6; cursor: pointer; transform: translateY(-1px); transition: all 0.2s; }
        /* Mobile Overlay Handling */
        #sidebar { transition: transform 0.3s ease-in-out; }
        .sidebar-closed { transform: translateX(-100%); }
    </style>
    <title>Our US Memories: Los Angeles</title>
</head>
<body>
    <div class="skip"><a href="#main-content">Skip to Main Content</a></div>
    <nav id="home-nav">
        <ul id = "nav-list">
            <li><a href = "index.html">Home</a></li>
            <li><a href = "ann-arbor.html">Ann Arbor</a></li>
            <li><a href = "new-york.html">New York</a></li>
            <li><a href = "los-angeles.html" class="active">Los Angeles</a></li>
            <li><a href = "san-francisco.html">San Francisco</a></li>
            <li><a href = "las-vegas.html">Las Vegas</a></li>
        </ul>
    </nav>
    <header id="los-angeles-header">
        <div class = "header-banner">
            <h1>Los Angeles</h1>
            <h2>Our LA Adventures</h2>
        </div>
    </header>

    <main id="main-content">
        <div class ="filter-tab">
            <p>Food</p>
            <p>Places</p>
            <p>Events</p>
        </div>
        <div class = "section-container" data-filter="Food">
            <!-- Food content -->
            <div class="content-container" id="food-1">
                <img src="images/los-angeles-food/IMG_0539.JPG" alt="Food photo 1">
            </div>
            <div class="content-container" id="food-2">
                <img src="images/los-angeles-food/IMG_0666.JPG" alt="Food photo 2">
            </div>
            <div class="content-container" id="food-3">
                <img src="images/los-angeles-food/IMG_1227.JPG" alt="Food photo 3">
            </div>
            <div class="content-container" id="food-4">
                <img src="images/los-angeles-food/IMG_1374.JPG" alt="Food photo 4">
            </div>
            <div class="content-container" id="food-5">
                <img src="images/los-angeles-food/IMG_1375.JPG" alt="Food photo 5">
            </div>
            <div class="content-container" id="food-6">
                <img src="images/los-angeles-food/IMG_1471.JPG" alt="Food photo 6">
            </div>
            <div class="content-container" id="food-7">
                <img src="images/los-angeles-food/IMG_1687.JPG" alt="Food photo 7">
            </div>
            <div class="content-container" id="food-8">
                <img src="images/los-angeles-food/IMG_1688.JPG" alt="Food photo 8">
            </div>
            <div class="content-container" id="food-9">
                <img src="images/los-angeles-food/IMG_1689.JPG" alt="Food photo 9">
            </div>
            <div class="content-container" id="food-10">
                <img src="images/los-angeles-food/IMG_2173.JPG" alt="Food photo 10">
            </div>
            <div class="content-container" id="food-11">
                <img src="images/los-angeles-food/IMG_2174.JPG" alt="Food photo 11">
            </div>
            <div class="content-container" id="food-12">
                <img src="images/los-angeles-food/IMG_2175.JPG" alt="Food photo 12">
            </div>
            <div class="content-container" id="food-13">
                <img src="images/los-angeles-food/IMG_2176.JPG" alt="Food photo 13">
            </div>
            <div class="content-container" id="food-14">
                <img src="images/los-angeles-food/IMG_2178.JPG" alt="Food photo 14">
            </div>
            <div class="content-container" id="food-15">
                <img src="images/los-angeles-food/IMG_2657.JPG" alt="Food photo 15">
            </div>
            <div class="content-container" id="food-16">
                <img src="images/los-angeles-food/IMG_2675.JPG" alt="Food photo 16">
            </div>
            <div class="content-container" id="food-17">
                <img src="images/los-angeles-food/IMG_2676.JPG" alt="Food photo 17">
            </div>
        </div>

        <div class = "section-container hidden" data-filter="Places">
            <!-- Places content -->
            <div class="content-container" id="places-1">
                <img src="images/los-angeles-places/IMG_0536.JPG" alt="Place photo 1">
            </div>
            <div class="content-container" id="places-2">
                <img src="images/los-angeles-places/IMG_0560.JPG" alt="Place photo 2">
            </div>
            <div class="content-container" id="places-3">
                <img src="images/los-angeles-places/IMG_0582.JPG" alt="Place photo 3">
            </div>
            <div class="content-container" id="places-4">
                <img src="images/los-angeles-places/IMG_0638.JPG" alt="Place photo 4">
            </div>
            <div class="content-container" id="places-5">
                <img src="images/los-angeles-places/IMG_0639.JPG" alt="Place photo 5">
            </div>
            <div class="content-container" id="places-6">
                <img src="images/los-angeles-places/IMG_0642.JPG" alt="Place photo 6">
            </div>
            <div class="content-container" id="places-7">
                <img src="images/los-angeles-places/IMG_0645.JPG" alt="Place photo 7">
            </div>
            <div class="content-container" id="places-8">
                <img src="images/los-angeles-places/IMG_0646.JPG" alt="Place photo 8">
            </div>
            <div class="content-container" id="places-9">
                <img src="images/los-angeles-places/IMG_0655.JPG" alt="Place photo 9">
            </div>
            <div class="content-container" id="places-10">
                <img src="images/los-angeles-places/IMG_0656.JPG" alt="Place photo 10">
            </div>
            <div class="content-container" id="places-11">
                <img src="images/los-angeles-places/IMG_0692.JPG" alt="Place photo 11">
            </div>
            <div class="content-container" id="places-12">
                <img src="images/los-angeles-places/IMG_0693.JPG" alt="Place photo 12">
            </div>
            <div class="content-container" id="places-13">
                <img src="images/los-angeles-places/IMG_0739.JPG" alt="Place photo 13">
            </div>
            <div class="content-container" id="places-14">
                <img src="images/los-angeles-places/IMG_0753.JPG" alt="Place photo 14">
            </div>
            <div class="content-container" id="places-15">
                <img src="images/los-angeles-places/IMG_0754.JPG" alt="Place photo 15">
            </div>
            <div class="content-container" id="places-16">
                <img src="images/los-angeles-places/IMG_0757.JPG" alt="Place photo 16">
            </div>
            <div class="content-container" id="places-17">
                <img src="images/los-angeles-places/IMG_0824.JPG" alt="Place photo 17">
            </div>
            <div class="content-container" id="places-18">
                <img src="images/los-angeles-places/IMG_0826.JPG" alt="Place photo 18">
            </div>
            <div class="content-container" id="places-19">
                <img src="images/los-angeles-places/IMG_0847.JPG" alt="Place photo 19">
            </div>
            <div class="content-container" id="places-20">
                <img src="images/los-angeles-places/IMG_0848.JPG" alt="Place photo 20">
            </div>
            <div class="content-container" id="places-21">
                <img src="images/los-angeles-places/IMG_0853.JPG" alt="Place photo 21">
            </div>
            <div class="content-container" id="places-22">
                <img src="images/los-angeles-places/IMG_0861.JPG" alt="Place photo 22">
            </div>
            <div class="content-container" id="places-23">
                <img src="images/los-angeles-places/IMG_0868.JPG" alt="Place photo 23">
            </div>
            <div class="content-container" id="places-24">
                <img src="images/los-angeles-places/IMG_0882.JPG" alt="Place photo 24">
            </div>
            <div class="content-container" id="places-25">
                <img src="images/los-angeles-places/IMG_0886.JPG" alt="Place photo 25">
            </div>
            <div class="content-container" id="places-26">
                <img src="images/los-angeles-places/IMG_0889.JPG" alt="Place photo 26">
            </div>
            <div class="content-container" id="places-27">
                <img src="images/los-angeles-places/IMG_1067.JPG" alt="Place photo 27">
            </div>
            <div class="content-container" id="places-28">
                <img src="images/los-angeles-places/IMG_1076.JPG" alt="Place photo 28">
            </div>
            <div class="content-container" id="places-29">
                <img src="images/los-angeles-places/IMG_1099.JPG" alt="Place photo 29">
            </div>
            <div class="content-container" id="places-30">
                <img src="images/los-angeles-places/IMG_1131.JPG" alt="Place photo 30">
            </div>
            <div class="content-container" id="places-31">
                <img src="images/los-angeles-places/IMG_1132.JPG" alt="Place photo 31">
            </div>
            <div class="content-container" id="places-32">
                <img src="images/los-angeles-places/IMG_1138.JPG" alt="Place photo 32">
            </div>
            <div class="content-container" id="places-33">
                <img src="images/los-angeles-places/IMG_1140.JPG" alt="Place photo 33">
            </div>
            <div class="content-container" id="places-34">
                <img src="images/los-angeles-places/IMG_1161.JPG" alt="Place photo 34">
            </div>
            <div class="content-container" id="places-35">
                <img src="images/los-angeles-places/IMG_1517.JPG" alt="Place photo 35">
            </div>
            <div class="content-container" id="places-36">
                <img src="images/los-angeles-places/IMG_1530.JPG" alt="Place photo 36">
            </div>
            <div class="content-container" id="places-37">
                <img src="images/los-angeles-places/IMG_1534.JPG" alt="Place photo 37">
            </div>
            <div class="content-container" id="places-38">
                <img src="images/los-angeles-places/IMG_1547.JPG" alt="Place photo 38">
            </div>
            <div class="content-container" id="places-39">
                <img src="images/los-angeles-places/IMG_1679.JPG" alt="Place photo 39">
            </div>
            <div class="content-container" id="places-40">
                <img src="images/los-angeles-places/IMG_1680.JPG" alt="Place photo 40">
            </div>
        </div>

        <div class = "section-container hidden" data-filter="Events">
            <!-- Events content - Interactive Map -->
            <div class="flex flex-col md:flex-row h-screen bg-gray-50 overflow-hidden" style="height: 80vh; min-height: 600px; width: 100%;">
                <!-- Mobile Header -->
                <div class="md:hidden bg-white shadow-md p-4 flex justify-between items-center z-50 relative">
                    <h1 class="font-bold text-lg text-gray-800">LA Itinerary May 6-13</h1>
                    <button id="menuToggle" class="text-gray-600 focus:outline-none">
                        <i class="fas fa-bars fa-lg"></i>
                    </button>
                </div>
                <!-- Sidebar / Itinerary List -->
                <div id="sidebar" class="w-full md:w-96 bg-white shadow-xl z-40 flex flex-col h-[calc(100%-60px)] md:h-full absolute md:relative sidebar-closed md:transform-none">
                    <div class="p-5 border-b bg-gray-50 hidden md:block">
                        <h1 class="text-2xl font-bold text-gray-800">LA Itinerary Map</h1>
                        <p class="text-sm text-gray-500 mt-1">May 6 - May 13</p>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto p-4 space-y-4" id="itinerary-list">
                        <!-- Content injected by JS -->
                    </div>
                    <div class="p-4 border-t bg-gray-50 text-xs text-gray-400 text-center">
                        Click cards to focus on route
                    </div>
                </div>
                <!-- Map Container -->
                <div class="flex-1 relative h-full">
                    <div id="events-map" style="height: 100%; width: 100%;"></div>
                    
                    <!-- Map Legend Overlay -->
                    <div class="absolute bottom-6 right-4 bg-white p-3 rounded-lg shadow-lg z-[1000] text-sm hidden md:block opacity-90">
                        <h4 class="font-bold mb-2 border-b pb-1">Legend</h4>
                        <div id="legend-content" class="space-y-1"></div>
                    </div>
                </div>
            </div>
            <script>
                // Initialize map when Events section becomes visible
                function initEventsMap() {
                    if (window.eventsMapInstance) {
                        setTimeout(() => {
                            window.eventsMapInstance.invalidateSize();
                        }, 100);
                        return;
                    }
                    
                    // --- Data: Itinerary Points & Routes ---
                    const itineraryData = [
                    {
                        date: "May 6",
                        title: "Arrival & Beach Day",
                        color: "#ef4444", // Red
                        description: "Apartment -> Santa Monica/Venice Beach -> Apartment",
                        points: [
                            { name: "Apartment (Approx)", lat: 34.0522, lng: -118.2437, note: "Check-in (approximate location)" },
                            { name: "Santa Monica Beach", lat: 34.0195, lng: -118.4912, note: "Beach visit" },
                            { name: "Venice Beach", lat: 34.0522, lng: -118.4737, note: "Beach walk" },
                            { name: "Hop Woo Restaurant", lat: 34.0500, lng: -118.2400, note: "Dinner" }
                        ]
                    },
                    {
                        date: "May 7",
                        title: "Art & Views",
                        color: "#3b82f6", // Blue
                        description: "Getty Center -> Beverly Hills -> Griffith Observatory",
                        points: [
                            { name: "Getty Center", lat: 34.0778, lng: -118.4751, note: "Museum visit" },
                            { name: "The Palace Seafood & Dim Sum", lat: 34.0600, lng: -118.3000, note: "Lunch" },
                            { name: "Beverly Hills", lat: 34.0736, lng: -118.4004, note: "Stroll around" },
                            { name: "Griffith Observatory", lat: 34.1184, lng: -118.3004, note: "Evening visit" },
                            { name: "Luv2eat Thai Bistro", lat: 34.0900, lng: -118.3000, note: "Dinner" }
                        ]
                    },
                    {
                        date: "May 8",
                        title: "Universal Studios",
                        color: "#10b981", // Emerald
                        description: "Full day at Universal Studios",
                        points: [
                            { name: "Universal Studios Hollywood", lat: 34.1381, lng: -118.3534, note: "Full day theme park" }
                        ]
                    },
                    {
                        date: "May 9",
                        title: "Downtown & Little Tokyo",
                        color: "#f59e0b", // Amber
                        description: "Downtown -> Little Tokyo -> Grand Park -> Angels Flight -> Last Bookstore -> Santa Monica",
                        points: [
                            { name: "Downtown LA", lat: 34.0522, lng: -118.2437, note: "Explore downtown" },
                            { name: "Sushi Gen", lat: 34.0500, lng: -118.2400, note: "Lunch" },
                            { name: "Little Tokyo", lat: 34.0500, lng: -118.2400, note: "Visit Little Tokyo" },
                            { name: "Gloria Molina Grand Park", lat: 34.0555, lng: -118.2467, note: "Park visit" },
                            { name: "Angels Flight Railway", lat: 34.0510, lng: -118.2500, note: "Historic funicular" },
                            { name: "The Last Bookstore", lat: 34.0500, lng: -118.2500, note: "Bookstore visit" },
                            { name: "Santa Monica", lat: 34.0195, lng: -118.4912, note: "Evening visit" },
                            { name: "La Ong Beverly Hills", lat: 34.0736, lng: -118.4004, note: "Dinner" }
                        ]
                    },
                    {
                        date: "May 10",
                        title: "Museums & Grove",
                        color: "#8b5cf6", // Violet
                        description: "Academy Museum -> Courty Museum -> Grove Fountain -> Disney Area",
                        points: [
                            { name: "Academy Museum", lat: 34.0678, lng: -118.3606, note: "Museum of Motion Pictures" },
                            { name: "Sun Nong Dan", lat: 34.0600, lng: -118.3000, note: "Lunch" },
                            { name: "Courty Museum (LACMA)", lat: 34.0639, lng: -118.3591, note: "Art museum" },
                            { name: "Grove Fountain", lat: 34.0716, lng: -118.3578, note: "Shopping & fountain" },
                            { name: "Disney Area Hotel", lat: 33.8121, lng: -117.9190, note: "Head to Disney area" },
                            { name: "Holy Basil DTLA", lat: 34.0500, lng: -118.2500, note: "Dinner" }
                        ]
                    },
                    {
                        date: "May 11-13",
                        title: "Disney & Departure",
                        color: "#ec4899", // Pink
                        description: "Disneyland -> Head to San Francisco",
                        points: [
                            { name: "Disneyland", lat: 33.8121, lng: -117.9190, note: "Multiple days at Disney" },
                            { name: "San Francisco", lat: 37.7749, lng: -122.4194, note: "Depart to SF (direction)" }
                        ]
                    }
                    ];
                    
                    // --- Map Initialization ---
                    // Check if map container exists before initializing
                    const mapContainer = document.getElementById('events-map');
                    if (!mapContainer) {
                        console.error('Map container not found');
                        return;
                    }
                    
                    // Initialize centered on Los Angeles
                    const eventsMap = L.map('events-map').setView([34.0522, -118.2437], 11);
                    
                    // Store map reference globally
                    window.eventsMapInstance = eventsMap;
                    window.eventsMapInitialized = true;

                    // Add CartoDB Voyager Tile Layer
                    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
                        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
                        subdomains: 'abcd',
                        maxZoom: 20
                    }).addTo(eventsMap);

                    // --- Render Itinerary ---
                    const layerGroups = {};
                    const sidebarList = document.getElementById('itinerary-list');
                    const legendContent = document.getElementById('legend-content');

                    itineraryData.forEach((day, index) => {
                        // 1. Create Feature Group for the day
                        const dayLayer = L.featureGroup();
                        
                        // 2. Create Route (Polyline) - only if multiple points
                        if (day.points.length > 1) {
                            const latLngs = day.points.map(p => [p.lat, p.lng]);
                            L.polyline(latLngs, {
                                color: day.color,
                                weight: 4,
                                opacity: 0.8,
                                dashArray: '5, 10',
                                lineJoin: 'round'
                            }).addTo(dayLayer);
                        }

                        // 3. Create Markers
                        day.points.forEach((point, i) => {
                            const markerHtml = `
                                <div style="background-color: ${day.color}; width: 24px; height: 24px; border-radius: 50%; border: 2px solid white; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">
                                    ${i + 1}
                                </div>`;
                            
                            const customIcon = L.divIcon({
                                className: 'custom-div-icon',
                                html: markerHtml,
                                iconSize: [24, 24],
                                iconAnchor: [12, 12]
                            });

                            L.marker([point.lat, point.lng], { icon: customIcon })
                                .bindPopup(`<b>${point.name}</b><br><span style="color:gray">${point.note}</span>`)
                                .addTo(dayLayer);
                        });

                        // Add layer to map
                        dayLayer.addTo(eventsMap);
                        layerGroups[day.date] = dayLayer;

                        // 4. Create Sidebar Element
                        const card = document.createElement('div');
                        card.className = "day-card bg-white p-4 rounded-lg shadow-sm border border-l-4";
                        card.style.borderLeftColor = day.color;
                        card.innerHTML = `
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-bold text-lg text-gray-800">${day.date}</span>
                                <span class="text-xs font-semibold px-2 py-1 rounded bg-gray-100 text-gray-600">Day ${index + 1}</span>
                            </div>
                            <h3 class="font-semibold text-gray-700 text-sm mb-1">${day.title}</h3>
                            <p class="text-xs text-gray-500 line-clamp-2">${day.description}</p>
                        `;
                        
                        // Click event to focus map
                        card.addEventListener('click', () => {
                            // Mobile: Close sidebar
                            if(window.innerWidth < 768) {
                                document.getElementById('sidebar').classList.add('sidebar-closed');
                            }
                            // Fit bounds with padding
                            if (layerGroups[day.date].getBounds().isValid()) {
                                eventsMap.fitBounds(layerGroups[day.date].getBounds(), { padding: [50, 50] });
                            } else {
                                // If single point, zoom to it
                                const point = day.points[0];
                                eventsMap.setView([point.lat, point.lng], 15);
                            }
                        });

                        sidebarList.appendChild(card);

                        // 5. Add to Legend
                        const legendItem = document.createElement('div');
                        legendItem.className = "flex items-center gap-2";
                        legendItem.innerHTML = `<div style="width: 12px; height: 12px; background-color: ${day.color}; border-radius: 50%;"></div><span>${day.date}</span>`;
                        legendContent.appendChild(legendItem);
                    });

                    // --- Mobile Sidebar Toggle ---
                    const menuBtn = document.getElementById('menuToggle');
                    const sidebar = document.getElementById('sidebar');
                    if(menuBtn && sidebar) {
                        menuBtn.addEventListener('click', () => {
                            sidebar.classList.toggle('sidebar-closed');
                        });
                    }

                    // Adjust view initially to fit all routes
                    const validLayers = Object.values(layerGroups).filter(layer => layer.getBounds().isValid());
                    if (validLayers.length > 0) {
                        const group = new L.featureGroup(validLayers);
                        eventsMap.fitBounds(group.getBounds(), { padding: [50, 50] });
                    }
                }
                
                // Initialize map when Events section becomes visible
                document.addEventListener('DOMContentLoaded', function() {
                    // Watch for Events section visibility changes
                    const observer = new MutationObserver(function(mutations) {
                        mutations.forEach(function(mutation) {
                            const eventsSection = document.querySelector('.section-container[data-filter="Events"]');
                            if (eventsSection && !eventsSection.classList.contains('hidden')) {
                                // Events section is now visible, initialize map if needed
                                setTimeout(initEventsMap, 150);
                            }
                        });
                    });
                    
                    // Observe the Events section container
                    const eventsSection = document.querySelector('.section-container[data-filter="Events"]');
                    if (eventsSection) {
                        observer.observe(eventsSection, {
                            attributes: true,
                            attributeFilter: ['class']
                        });
                    }
                });
            </script>
        </div>

    </main>
    <script src = "js/gallery.js"></script>
</body>
</html>

